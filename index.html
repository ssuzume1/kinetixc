<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kinetix । Largest Quality Content Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <style>
        :root { --primary: #6366f1; --bg: #f8fafc; --card: #ffffff; --text: #0f172a; --text-dim: #64748b; --border: #e2e8f0; }
        [data-theme="dark"] { --bg: #020617; --card: #0f172a; --text: #f1f5f9; --text-dim: #94a3b8; --border: #1e293b; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); transition: 0.3s; min-height: 100vh; }
        
        nav { position: sticky; top: 0; z-index: 1000; background: var(--card); border-bottom: 1px solid var(--border); padding: 0.7rem 5%; display: flex; justify-content: space-between; align-items: center; gap: 10px; }
        .logo { font-size: 1.5rem; font-weight: 800; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }
        
        .search-wrap { position: relative; flex: 1; max-width: 500px; }
        .search-wrap input { width: 100%; padding: 0.6rem 1rem 0.6rem 2.5rem; border-radius: 12px; border: 1px solid var(--border); background: var(--bg); color: var(--text); outline: none; }
        .search-wrap i { position: absolute; left: 0.8rem; top: 50%; transform: translateY(-50%); color: var(--text-dim); }
        
        .nav-icons { display: flex; gap: 8px; }
        .btn-icon { width: 38px; height: 38px; border-radius: 10px; border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; cursor: pointer; background: var(--card); }

        .container { max-width: 1200px; margin: 1.5rem auto; padding: 0 1rem; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
        .section-title { font-size: 1.4rem; font-weight: 800; display: flex; align-items: center; gap: 10px; }
        .section-title::before { content: ''; width: 4px; height: 24px; background: var(--primary); border-radius: 10px; }
        .counter-badge { font-size: 0.75rem; background: var(--primary); color: white; padding: 4px 12px; border-radius: 20px; font-weight: 700; }

        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1.5rem; }
        .m-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; overflow: hidden; position: relative; transition: 0.3s; display: flex; flex-direction: column; }
        .m-card:hover { transform: translateY(-5px); border-color: var(--primary); }
        
        .m-poster-wrap { position: relative; width: 100%; aspect-ratio: 2/3; background: #1e293b; overflow: hidden; }
        .m-poster { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.5s ease; }
        .m-poster.loaded { opacity: 1; }
        
        .tag-quality { position: absolute; top: 10px; left: 10px; background: var(--primary); color: white; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 800; text-transform: uppercase; z-index: 5; }
        
        .m-details { padding: 1.2rem; flex-grow: 1; display: flex; flex-direction: column; }
        .m-info { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
        .m-title { font-weight: 700; font-size: 1rem; line-height: 1.3; color: var(--text); }
        .m-meta { text-align: right; min-width: 70px; }
        .tag-rating { background: #facc15; color: #713f12; padding: 2px 6px; border-radius: 6px; font-weight: 800; font-size: 0.75rem; }
        .tag-audio { display: block; font-size: 0.7rem; color: var(--text-dim); margin-top: 4px; font-weight: 600; }
        
        .btn-dl { display: block; width: 100%; text-align: center; background: var(--primary); color: white; padding: 0.8rem; border-radius: 10px; text-decoration: none; font-weight: 700; margin-top: auto; }
        .btn-del { position: absolute; top: 10px; right: 10px; background: #ef4444; color: white; border: none; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; z-index: 10; display: none; }
        
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; padding: 1rem; overflow-y: auto; }
        .m-box { background: var(--card); max-width: 400px; margin: 2rem auto; padding: 2rem; border-radius: 20px; position: relative; }
        .close-m { position: absolute; right: 20px; top: 15px; font-size: 1.5rem; cursor: pointer; }
        .inp-group { margin-bottom: 1rem; }
        .inp-group label { display: block; font-size: 0.85rem; font-weight: 600; margin-bottom: 4px; color: var(--text-dim); }
        .inp-group input { width: 100%; padding: 0.7rem; border-radius: 10px; border: 1px solid var(--border); background: var(--bg); color: var(--text); outline: none; }
        .btn-go { width: 100%; padding: 0.8rem; border-radius: 10px; border: none; background: var(--primary); color: white; font-weight: 800; cursor: pointer; }
        
        .footer-req { margin: 4rem 0; text-align: center; }
        .req-link { background: var(--text); color: var(--bg); padding: 0.7rem 2rem; border-radius: 50px; text-decoration: none; font-weight: 600; border: 1px solid var(--border); }
    </style>
</head>
<body data-theme="dark">

    <nav>
        <div class="logo">Kinetix</div>
        <div class="search-wrap"><i class="fa-solid fa-search"></i><input type="text" id="qInput" placeholder="Quick search..." onkeyup="doSearch()"></div>
        <div class="nav-icons">
            <div class="btn-icon" onclick="toggleTheme()"><i class="fa-solid fa-circle-half-stroke"></i></div>
            <div class="btn-icon" onclick="openAdmin()"><i class="fa-solid fa-user-shield"></i></div>
        </div>
    </nav>

    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Latest Uploads</h2>
            <div id="countBadge" class="counter-badge">0 Titles</div>
        </div>
        <div class="movie-grid" id="mGrid"></div>
        <div class="footer-req"><a href="#" id="reqURL" class="req-link">Request Content</a></div>
    </div>

    <div id="loginModal" class="overlay">
        <div class="m-box"><span class="close-m" onclick="closeM()">&times;</span><h3>Admin Login</h3><br>
            <div class="inp-group"><label>User</label><input type="text" id="u"></div>
            <div class="inp-group"><label>Pass</label><input type="password" id="p"></div>
            <button class="btn-go" onclick="doLogin()">Authorize</button>
        </div>
    </div>

    <div id="adminModal" class="overlay">
        <div class="m-box"><span class="close-m" onclick="closeM()">&times;</span><h3>Publish Movie</h3><br>
            <div class="inp-group"><label>IMDb ID (e.g. tt1877830)</label><input type="text" id="imdbID"></div>
            <div class="inp-group"><label>Custom Poster URL (Optional)</label><input type="text" id="customPoster" placeholder="https://link-to-image.jpg"></div>
            <div class="inp-group"><label>Quality</label><input type="text" id="qlt" placeholder="1080p"></div>
            <div class="inp-group"><label>Audio</label><input type="text" id="aud" placeholder="Dual Audio"></div>
            <div class="inp-group"><label>Download URL</label><input type="text" id="dlLink"></div>
            <div class="inp-group"><label>Update Request URL</label><input type="text" id="rLink"></div>
            <button class="btn-go" id="addBtn" onclick="saveMovie()">Confirm & Publish</button>
            <button class="btn-go" style="background:#475569; margin-top:10px;" onclick="logout()">Logout</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBWMgvC7lJKwc8D9dbm3Q1ozMCFfmrdxDo",
            authDomain: "kinetix-52add.firebaseapp.com",
            projectId: "kinetix-52add",
            storageBucket: "kinetix-52add.firebasestorage.app",
            messagingSenderId: "151982942702",
            appId: "1:151982942702:web:00c4b2a31853903e8886ff",
            measurementId: "G-PMPQ8TL07B"
        };
        const OMDB_KEY = '38785e98';
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function sync() {
            db.collection("movies").orderBy("createdAt", "desc").onSnapshot((snap) => {
                const movies = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                render(movies);
                document.getElementById('countBadge').innerText = `${snap.size} Titles`;
            });
            db.collection("settings").doc("config").onSnapshot(doc => {
                if(doc.exists()) document.getElementById('reqURL').href = doc.data().url;
            });
        }

        function render(data) {
            const grid = document.getElementById('mGrid');
            const isAdmin = sessionStorage.getItem('kx_admin') === 'true';
            grid.innerHTML = data.map((m) => {
                // High-speed Google proxy for images
                const fastPoster = `https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?container=focus&refresh=2592000&url=${encodeURIComponent(m.poster)}`;
                return `
                <div class="m-card">
                    ${isAdmin ? `<button class="btn-del" style="display:block" onclick="remove('${m.id}')"><i class="fa-solid fa-trash"></i></button>` : ''}
                    <div class="m-poster-wrap">
                        <span class="tag-quality">${m.quality}</span>
                        <img class="m-poster" src="${fastPoster}" alt="Poster" onload="this.classList.add('loaded')" loading="lazy">
                    </div>
                    <div class="m-details">
                        <div class="m-info">
                            <div class="m-title">${m.title} <span style="font-weight:400; color:var(--text-dim)">(${m.year})</span></div>
                            <div class="m-meta"><span class="tag-rating">★ ${m.rating}</span><span class="tag-audio">${m.audio}</span></div>
                        </div>
                        <a href="${m.link}" class="btn-dl" target="_blank">Download</a>
                    </div>
                </div>
                `;
            }).join('');
        }

        async function saveMovie() {
            const id = document.getElementById('imdbID').value.trim();
            const customImg = document.getElementById('customPoster').value.trim();
            const qlt = document.getElementById('qlt').value || '1080p';
            const aud = document.getElementById('aud').value || 'Multi';
            const lnk = document.getElementById('dlLink').value.trim();
            const rLink = document.getElementById('rLink').value.trim();

            if (rLink) await db.collection("settings").doc("config").set({ url: rLink });
            if (!id || !lnk) return alert('ID and Link required');

            document.getElementById('addBtn').innerText = 'Fetching...';
            try {
                const res = await fetch(`https://www.omdbapi.com/?i=${id}&apikey=${OMDB_KEY}`);
                const d = await res.json();
                if(d.Response === "True") {
                    const finalPoster = customImg || (d.Poster !== "N/A" ? d.Poster : 'https://via.placeholder.com/400x600');
                    await db.collection("movies").add({
                        title: d.Title, year: d.Year, rating: d.imdbRating,
                        audio: aud, quality: qlt, link: lnk,
                        poster: finalPoster,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    closeM();
                } else { alert(d.Error); }
            } catch (e) { alert('API Error'); }
            document.getElementById('addBtn').innerText = 'Confirm & Publish';
        }

        async function remove(id) { if(confirm('Delete Globally?')) await db.collection("movies").doc(id).delete(); }
        function doLogin() {
            if(document.getElementById('u').value === 'doverx' && document.getElementById('p').value === 'maya123') {
                sessionStorage.setItem('kx_admin', 'true');
                closeM(); sync();
            } else alert('Access Denied');
        }
        function toggleTheme() { document.body.setAttribute('data-theme', document.body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'); }
        function openAdmin() { if(sessionStorage.getItem('kx_admin')) document.getElementById('adminModal').style.display='block'; else document.getElementById('loginModal').style.display='block'; }
        function closeM() { document.querySelectorAll('.overlay').forEach(o => o.style.display='none'); }
        function logout() { sessionStorage.clear(); location.reload(); }
        function doSearch() { 
            const val = document.getElementById('qInput').value.toLowerCase();
            document.querySelectorAll('.m-card').forEach(card => {
                const title = card.querySelector('.m-title').innerText.toLowerCase();
                card.style.display = title.includes(val) ? 'flex' : 'none';
            });
        }
        window.onload = sync;
    </script>
</body>
</html>