<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kinetix - Your High Quality Media Hub</title>
    
    <link rel="icon" type="image/png" href="https://i.ibb.co/tM0b10VH/361ab327-15bc-498d-8915-00ce98208706.jpg">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://wsrv.nl">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <style>
        :root { --primary: #6366f1; --bg: #020617; --card: #0f172a; --text: #f1f5f9; --text-dim: #94a3b8; --border: #1e293b; --accent: #facc15; }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }
        
        /* Navigation with your specific Logo */
        nav { position: sticky; top: 0; z-index: 1000; background: rgba(15, 23, 42, 0.9); border-bottom: 1px solid var(--border); padding: 0.7rem 5%; display: flex; justify-content: space-between; align-items: center; backdrop-filter: blur(15px); }
        .nav-left { display: flex; align-items: center; gap: 12px; }
        .nav-logo-img { width: 38px; height: 38px; border-radius: 8px; object-fit: cover; border: 1px solid var(--border); }
        .logo-text { font-size: 1.5rem; font-weight: 800; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }
        
        .search-wrap { position: relative; flex: 1; max-width: 400px; margin: 0 15px; }
        .search-wrap input { width: 100%; padding: 0.6rem 1rem 0.6rem 2.5rem; border-radius: 12px; border: 1px solid var(--border); background: var(--bg); color: var(--text); outline: none; transition: 0.2s; }
        .search-wrap input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); }
        .search-wrap i { position: absolute; left: 0.8rem; top: 50%; transform: translateY(-50%); color: var(--text-dim); }
        
        .nav-icons { display: flex; gap: 10px; }
        .btn-icon { width: 40px; height: 40px; border-radius: 10px; border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; cursor: pointer; background: var(--card); transition: 0.2s; }
        .btn-icon:hover { border-color: var(--primary); color: var(--primary); }

        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; padding-bottom: 120px; }
        
        /* Dashboard Stats */
        #adminDashboardStats { display: none; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: var(--card); padding: 1.5rem; border-radius: 16px; border: 1px solid var(--border); border-top: 3px solid var(--primary); }
        .stat-card h4 { font-size: 0.75rem; text-transform: uppercase; color: var(--text-dim); margin-bottom: 5px; }
        .stat-card p { font-size: 1.6rem; font-weight: 800; }

        /* Media Grid */
        .movie-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
        .m-card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; overflow: hidden; position: relative; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; }
        .m-card:hover { transform: translateY(-8px); border-color: var(--primary); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        
        .m-poster-wrap { position: relative; width: 100%; aspect-ratio: 2/3; background: #000; overflow: hidden; }
        .m-poster { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: 0.6s; }
        .m-poster.loaded { opacity: 1; }
        .tag-quality { position: absolute; top: 10px; left: 10px; background: var(--primary); color: white; padding: 5px 10px; border-radius: 6px; font-size: 0.65rem; font-weight: 800; z-index: 5; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        
        .m-details { padding: 1.2rem; flex-grow: 1; display: flex; flex-direction: column; }
        .m-title { font-weight: 700; font-size: 1rem; line-height: 1.3; margin-bottom: 10px; height: 2.6rem; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }
        .m-meta { display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; color: var(--text-dim); margin-bottom: 15px; }
        .tag-rating { color: var(--accent); font-weight: 800; border: 1px solid var(--accent); padding: 1px 6px; border-radius: 4px; }
        
        .btn-dl { display: block; width: 100%; text-align: center; background: var(--primary); color: white; padding: 0.8rem; border-radius: 12px; text-decoration: none; font-weight: 800; font-size: 0.9rem; margin-top: auto; transition: 0.2s; }
        .btn-dl:hover { filter: brightness(1.2); transform: scale(1.02); }

        /* FLOATING REQUEST PILL */
        .request-float { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 100; }
        .req-link { display: flex; align-items: center; gap: 12px; background: #ffffff; color: #000000; padding: 14px 35px; border-radius: 50px; text-decoration: none; font-weight: 800; font-size: 1rem; box-shadow: 0 15px 40px rgba(0,0,0,0.6); transition: 0.3s; }
        .req-link:hover { transform: translateY(-5px) scale(1.05); background: var(--primary); color: #fff; }

        /* Dashboard/Modal Overlays */
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.92); z-index: 2000; padding: 1.5rem; overflow-y: auto; backdrop-filter: blur(15px); }
        .dash-box { background: var(--card); max-width: 900px; margin: 1rem auto; padding: 2.5rem; border-radius: 24px; border: 1px solid var(--border); box-shadow: 0 25px 50px rgba(0,0,0,0.5); }
        .dash-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; }
        
        .admin-section { background: rgba(255,255,255,0.03); padding: 2rem; border-radius: 20px; border: 1px solid var(--border); }
        .admin-section h3 { margin-bottom: 1.5rem; color: var(--primary); font-size: 1.1rem; display: flex; align-items: center; gap: 10px; }
        
        input { width: 100%; padding: 0.9rem; margin-bottom: 15px; border-radius: 12px; border: 1px solid var(--border); background: var(--bg); color: #fff; outline: none; transition: 0.2s; }
        input:focus { border-color: var(--primary); }
        .btn-action { width: 100%; padding: 0.9rem; border-radius: 12px; border: none; font-weight: 800; cursor: pointer; transition: 0.2s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: #334155; color: white; margin-top: 15px; }
        
        .btn-del { position: absolute; top: 10px; right: 10px; background: #ef4444; color: white; border: none; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; display: none; z-index: 10; font-size: 12px; }

        @media (max-width: 600px) { .movie-grid { grid-template-columns: 1fr 1fr; gap: 12px; } .search-wrap { display: none; } .logo-text { font-size: 1.2rem; } }
    </style>
</head>
<body data-theme="dark">

    <nav>
        <div class="nav-left">
            <img src="https://i.ibb.co/tM0b10VH/361ab327-15bc-498d-8915-00ce98208706.jpg" alt="Kinetix Logo" class="nav-logo-img">
            <div class="logo-text">Kinetix</div>
        </div>
        <div class="search-wrap">
            <i class="fa-solid fa-search"></i>
            <input type="text" id="qInput" placeholder="Quick find content..." onkeyup="doSearch()">
        </div>
        <div class="nav-icons">
            <div class="btn-icon" onclick="openAdmin()"><i class="fa-solid fa-gauge-high"></i></div>
        </div>
    </nav>

    <div class="container">
        <div id="adminDashboardStats">
            <div class="stat-card"><h4>Media Library</h4><p id="statCount">0 Items</p></div>
            <div class="stat-card"><h4>Node Health</h4><p style="font-size:1rem; color:#10b981">● Connected</p></div>
            <div class="stat-card"><h4>Access Mode</h4><p style="font-size:1rem;">Super Admin</p></div>
        </div>

        <div class="movie-grid" id="mGrid"></div>
    </div>

    <div class="request-float">
        <a href="#" id="reqURL" target="_blank" class="req-link">
            <i class="fa-solid fa-paper-plane"></i> Request Content
        </a>
    </div>

    <div id="adminModal" class="overlay">
        <div class="dash-box">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2.5rem;">
                <h2 style="font-size:1.8rem"><i class="fa-solid fa-sliders"></i> Master Control</h2>
                <button onclick="closeM()" style="background:none; border:none; color:#fff; font-size:2.5rem; cursor:pointer; line-height:1">&times;</button>
            </div>
            
            <div class="dash-grid">
                <div class="admin-section">
                    <h3><i class="fa-solid fa-plus-circle"></i> Publish Content</h3>
                    <input type="text" id="imdbID" placeholder="IMDb ID (tt1234567)">
                    <input type="text" id="manualImg" placeholder="Manual Image Link (Optional)">
                    <input type="text" id="qlt" placeholder="Format (e.g. 2160p 10-Bit)">
                    <input type="text" id="aud" placeholder="Audio (e.g. Dual Audio)">
                    <input type="text" id="dlLink" placeholder="Direct Download Link">
                    <button class="btn-action btn-primary" id="addBtn" onclick="saveMovie()">Confirm & Publish</button>
                </div>

                <div class="admin-section">
                    <h3><i class="fa-solid fa-globe"></i> Hub Settings</h3>
                    <p style="font-size:0.8rem; color:var(--text-dim); margin-bottom:10px;">Set Permanent Request Link:</p>
                    <input type="text" id="rLink" placeholder="https://t.me/yourchannel">
                    <button class="btn-action btn-primary" style="background:#10b981" onclick="updateSettings()">Apply Globally</button>
                    
                    <div style="margin-top:2.5rem; padding-top:1.5rem; border-top:1px solid var(--border);">
                        <button class="btn-action btn-secondary" onclick="logout()"><i class="fa-solid fa-lock"></i> Exit Dashboard</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="loginModal" class="overlay">
        <div style="max-width:380px; margin:15vh auto; background:var(--card); padding:2.5rem; border-radius:24px; text-align:center; border:1px solid var(--border);">
            <img src="https://i.ibb.co/tM0b10VH/361ab327-15bc-498d-8915-00ce98208706.jpg" style="width:70px; height:70px; border-radius:12px; margin-bottom:1.5rem; border:1px solid var(--border);">
            <h3 style="margin-bottom:1.5rem">Admin Verification</h3>
            <input type="text" id="u" placeholder="Admin ID">
            <input type="password" id="p" placeholder="Security Key">
            <button class="btn-action btn-primary" onclick="doLogin()">Authorize Access</button>
        </div>
    </div>

    <script>
        // FIREBASE SETUP
        const firebaseConfig = {
            apiKey: "AIzaSyBWMgvC7lJKwc8D9dbm3Q1ozMCFfmrdxDo",
            authDomain: "kinetix-52add.firebaseapp.com",
            projectId: "kinetix-52add",
            storageBucket: "kinetix-52add.firebasestorage.app",
            messagingSenderId: "151982942702",
            appId: "1:151982942702:web:00c4b2a31853903e8886ff",
            measurementId: "G-PMPQ8TL07B"
        };
        const OMDB_KEY = '38785e98';

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // LIVE SYNC ENGINE
        function sync() {
            db.collection("movies").orderBy("createdAt", "desc").onSnapshot((snap) => {
                const movies = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                render(movies);
                document.getElementById('statCount').innerText = `${snap.size} Items`;
            });

            db.collection("settings").doc("global").onSnapshot(doc => {
                if(doc.exists()) {
                    const url = doc.data().requestUrl;
                    document.getElementById('reqURL').href = url;
                    document.getElementById('rLink').value = url;
                }
            });

            if(sessionStorage.getItem('kx_admin') === 'true') {
                document.getElementById('adminDashboardStats').style.display = 'grid';
            }
        }

        function render(data) {
            const grid = document.getElementById('mGrid');
            const isAdmin = sessionStorage.getItem('kx_admin') === 'true';
            
            grid.innerHTML = data.map((m) => {
                const fastPoster = `https://wsrv.nl/?url=${encodeURIComponent(m.poster)}&w=400&output=webp&q=80`;
                return `
                <div class="m-card">
                    ${isAdmin ? `<button class="btn-del" style="display:block" onclick="remove('${m.id}')"><i class="fa-solid fa-trash-alt"></i></button>` : ''}
                    <div class="m-poster-wrap">
                        <span class="tag-quality">${m.quality}</span>
                        <img class="m-poster" src="${fastPoster}" alt="Poster" onload="this.classList.add('loaded')" loading="lazy">
                    </div>
                    <div class="m-details">
                        <div class="m-title">${m.title}</div>
                        <div class="m-meta">
                            <span>${m.year} • ${m.audio}</span>
                            <span class="tag-rating">★ ${m.rating}</span>
                        </div>
                        <a href="${m.link}" class="btn-dl" target="_blank">Download</a>
                    </div>
                </div>`;
            }).join('');
        }

        async function saveMovie() {
            const id = document.getElementById('imdbID').value.trim();
            const manual = document.getElementById('manualImg').value.trim();
            const qlt = document.getElementById('qlt').value || '1080p';
            const aud = document.getElementById('aud').value || 'Dual Audio';
            const lnk = document.getElementById('dlLink').value.trim();

            if (!id || !lnk) return alert('Error: IMDb ID and Link are mandatory.');

            const btn = document.getElementById('addBtn');
            btn.innerText = 'Communicating with OMDb...';
            btn.disabled = true;

            try {
                const res = await fetch(`https://www.omdbapi.com/?i=${id}&apikey=${OMDB_KEY}`);
                const d = await res.json();
                if(d.Response === "True") {
                    const finalImg = manual || (d.Poster !== "N/A" ? d.Poster : 'https://via.placeholder.com/600x900');
                    await db.collection("movies").add({
                        title: d.Title, year: d.Year, rating: d.imdbRating,
                        audio: aud, quality: qlt, link: lnk, poster: finalImg,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    document.getElementById('imdbID').value = '';
                    document.getElementById('dlLink').value = '';
                    alert('Global Sync Complete!');
                } else alert(d.Error);
            } catch (e) { alert('API Network Failure.'); }
            
            btn.innerText = 'Confirm & Publish';
            btn.disabled = false;
        }

        async function updateSettings() {
            const url = document.getElementById('rLink').value.trim();
            if(!url) return;
            await db.collection("settings").doc("global").set({ requestUrl: url });
            alert('Settings Saved Permanently!');
        }

        async function remove(id) { if(confirm('Wipe from Library?')) await db.collection("movies").doc(id).delete(); }

        function doLogin() {
            if(document.getElementById('u').value === 'doverx' && document.getElementById('p').value === 'maya123') {
                sessionStorage.setItem('kx_admin', 'true');
                location.reload();
            } else alert('Credentials Rejected.');
        }
        function openAdmin() {
            if(sessionStorage.getItem('kx_admin') === 'true') document.getElementById('adminModal').style.display='block';
            else document.getElementById('loginModal').style.display='block';
        }
        function closeM() { document.querySelectorAll('.overlay').forEach(o => o.style.display='none'); }
        function logout() { sessionStorage.clear(); location.reload(); }
        function doSearch() { 
            const val = document.getElementById('qInput').value.toLowerCase();
            document.querySelectorAll('.m-card').forEach(card => {
                const title = card.querySelector('.m-title').innerText.toLowerCase();
                card.style.display = title.includes(val) ? 'flex' : 'none';
            });
        }
        window.onload = sync;
    </script>
</body>
</html>